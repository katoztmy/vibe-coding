# 技術選定

## プログラミング言語

| 言語       | バージョン | 選定理由                                       | 用途                             |
| ---------- | ---------- | ---------------------------------------------- | -------------------------------- |
| TypeScript | 5.0 以上   | 型安全性の確保、開発効率の向上、バグの早期発見 | フロントエンド・バックエンド共通 |
| JavaScript | ES2022     | TypeScript のトランスパイル先として            | 実行環境                         |

## フレームワーク

| フレームワーク | バージョン | 選定理由                                                                                                            | 用途                                             |
| -------------- | ---------- | ------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| Next.js        | 14.0 以上  | SSR と CSR 両方のサポート、ファイルベースルーティング、API Routes によるバックエンド構築、Vercel への簡単なデプロイ | フロントエンドとバックエンドの統合フレームワーク |
| React          | 18.0 以上  | コンポーネントベースの開発、仮想 DOM による高速描画、豊富なエコシステム                                             | UI コンポーネント構築                            |

## ライブラリ

| ライブラリ         | バージョン | 選定理由                                                             | 用途                                                    |
| ------------------ | ---------- | -------------------------------------------------------------------- | ------------------------------------------------------- |
| Tailwind CSS       | 3.0 以上   | ユーティリティファーストの CSS、モバイル対応の容易さ、カスタマイズ性 | スタイリング                                            |
| React Query        | 4.0 以上   | サーバー状態管理、キャッシング、再取得の最適化                       | API データ取得・管理                                    |
| Zod                | 3.0 以上   | 型安全なバリデーション、TypeScript との統合                          | フォームバリデーション、API リクエスト/レスポンスの検証 |
| OpenAI Node.js SDK | 最新       | OpenAI API との連携を容易にする                                      | AI テキスト変換処理                                     |
| Supabase JS Client | 最新       | Supabase とのインテグレーションのための SDK                          | データベース操作、認証                                  |
| next-share         | 最新       | ソーシャルシェアボタンの実装                                         | X（旧 Twitter）と LINE へのシェア機能                   |
| React Hook Form    | 7.0 以上   | 高性能なフォーム管理                                                 | フォーム処理                                            |
| React-toastify     | 最新       | トースト通知の実装                                                   | ユーザーフィードバック表示                              |
| dayjs              | 最新       | 日時フォーマット、計算のための軽量ライブラリ                         | 日付関連処理                                            |

## バックエンドサービス

| サービス   | 選定理由                                                                                    | 用途                             |
| ---------- | ------------------------------------------------------------------------------------------- | -------------------------------- |
| Supabase   | PostgreSQL ベースで拡張性が高い、認証機能の組込み、RLS によるセキュリティ確保、無料枠の充実 | データベース、認証、ストレージ   |
| OpenAI API | AI テキスト生成の信頼性、多様な調整オプション                                               | テキスト変換（大喜利、川柳生成） |

## 設計・アーキテクチャ

| 項目                 | 選定アプローチ                   | 理由                                                   |
| -------------------- | -------------------------------- | ------------------------------------------------------ |
| フロントエンド設計   | コンポーネント指向アーキテクチャ | 再利用性、保守性、開発効率の向上                       |
| ディレクトリ構造     | 機能ベース（Feature-based）構造  | 関連コードの近接配置によるコードナビゲーションの容易さ |
| 状態管理             | React Query とローカルステート   | サーバー状態とクライアント状態の明確な分離             |
| API パターン         | RESTful API                      | 単純さ、広く採用されている標準との整合性               |
| レスポンシブデザイン | モバイルファースト               | PRD の要件に合致、ユーザーの利用シーンに適合           |

## 開発ツール

| ツール   | 用途               | 選定理由                                             |
| -------- | ------------------ | ---------------------------------------------------- |
| ESLint   | コード品質チェック | 一貫したコードスタイル、潜在的なバグの検出           |
| Prettier | コードフォーマット | 自動整形によるコードの一貫性確保                     |
| Jest     | ユニットテスト     | React コンポーネントのテストに最適、広く採用         |
| Cypress  | E2E テスト         | ブラウザベースの実際のユーザー操作をシミュレート     |
| Git      | バージョン管理     | 業界標準、複数人での開発に必須                       |
| GitHub   | コード共有、CI/CD  | 広く採用されている、GitHub Actions による自動化      |
| Vercel   | デプロイ           | Next.js との統合、無料枠の充実、簡単なデプロイフロー |

## 開発ルール

| カテゴリ           | ルール                                               |
| ------------------ | ---------------------------------------------------- |
| コミットメッセージ | Conventional Commits に準拠（feat, fix, docs など）  |
| ブランチ戦略       | GitHub Flow（main + feature branches）               |
| コードレビュー     | PR ごとに少なくとも 1 人のレビュアーが必要           |
| テスト             | 重要なコンポーネントと機能に対するユニットテスト必須 |
| ドキュメント       | JSDoc によるコードドキュメント、README.md の更新     |
| 型安全性           | strict mode での TypeScript、any の使用を最小限に    |

## デプロイ・インフラ

| 項目         | 選定技術                                              | 理由                                     |
| ------------ | ----------------------------------------------------- | ---------------------------------------- |
| ホスティング | Vercel                                                | Next.js との統合、簡単なデプロイ、無料枠 |
| データベース | Supabase                                              | PostgreSQL ベース、Auth 連携、無料枠     |
| CI/CD        | GitHub Actions + Vercel                               | 自動テスト、自動デプロイの実現           |
| 環境変数管理 | Vercel 環境変数                                       | 本番/開発環境の分離、シークレット管理    |
| ドメイン     | Vercel ドメイン（初期）、必要に応じてカスタムドメイン | 早期リリースのコスト削減                 |
| 監視         | Vercel Analytics                                      | パフォーマンス、エラー監視               |

## 選定理由の詳細

### Next.js + React

- モバイルファースト要件に適した SPA 構築が可能
- API ルートを使用したサーバーサイド機能の実装が簡単
- Vercel への簡単なデプロイによる運用コスト削減
- TypeScript との相性が良く、型安全性を確保

### Supabase

- ユーザー認証機能が組み込まれており、実装コストを削減
- PostgreSQL ベースで拡張性が高く、将来の機能追加に対応可能
- Row Level Security（RLS）によるデータアクセス制御が容易
- リアルタイム機能が将来的な拡張で活用可能

### Tailwind CSS

- モバイルファーストのレスポンシブデザインが容易
- ユーティリティクラスによる高速な開発
- カスタマイズ性が高く、独自のデザインシステムの構築が可能
- ビルド時の最適化による CSS ファイルサイズの削減

### OpenAI API

- 高品質なテキスト生成能力（GPT-3.5/4）
- 多様なプロンプト調整オプションによる出力の制御
- API キーによる簡単な統合
- サーバーサイドでの利用により、クライアントへのキー漏洩リスクを回避

## 代替技術の検討

| 検討した技術        | 選択しなかった理由                                              |
| ------------------- | --------------------------------------------------------------- |
| Firebase            | Supabase の方が PostgreSQL ベースで柔軟性が高い、費用対効果     |
| Redux               | React Query で十分、ボイラープレートの削減                      |
| MUI                 | Tailwind CSS の方がカスタマイズ性が高く、バンドルサイズが小さい |
| Express.js          | Next.js の API Routes で十分、追加の複雑さを避ける              |
| AWS Amplify         | Vercel の方が Next.js との統合が優れている、運用が簡単          |
| GPT-2/3 self-hosted | 運用コスト、品質の観点から OpenAI API を選択                    |

## 将来的な技術検討

- リアルタイム機能の追加：Supabase Realtime
- バックグラウンド処理：Vercel Cron Jobs
- SEO 対策：Next.js App Router への移行
- パフォーマンス向上：Edge Functions
- 多言語対応：i18next
- 分析機能強化：データウェアハウス連携
